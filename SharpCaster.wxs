<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package
    Name="SharpCaster"
    Version="3.0.0"
    Manufacturer="Tapanila"
    UpgradeCode="1f0a8a1b-785c-4b2f-981c-9c36ad8f9fd3">
    <MajorUpgrade DowngradeErrorMessage="A newer version of SharpCaster is already installed." />
    <MediaTemplate EmbedCab="yes" CompressionLevel="high" />
    <Icon Id="SharpCasterIcon" SourceFile="SharpCaster.ico" />
    <Property Id="ARPPRODUCTICON" Value="SharpCasterIcon" />
    
    <Feature Id="ProductFeature" Title="SharpCaster" Level="1">
      <ComponentGroupRef Id="AppComponents" />
    </Feature>
  </Package>
  
  <Fragment>
	<StandardDirectory Id="ProgramFiles6432Folder">
		<Directory Id="CompanyFolder" Name="!(bind.Property.Manufacturer)">
			<Directory Id="INSTALLFOLDER" Name="!(bind.Property.ProductName)" />
		</Directory>
	</StandardDirectory>
    <ComponentGroup Id="AppComponents" Directory="INSTALLFOLDER">
      <Component Id="SharpCasterExecutable" Guid="5d457ed0-34a2-4b1c-8dea-b60a67554596">
		<?if $(var.Platform) = Arm64?>
		  <File Id="SharpCasterExe" Name="SharpCaster.exe" Source="sharpcaster-win-arm.exe"/>
		<?else?>
		  <File Id="SharpCasterExe" Name="SharpCaster.exe" Source="sharpcaster-win-x64.exe" />
		<?endif?>
      </Component>
    </ComponentGroup>
  </Fragment>
</Wix>